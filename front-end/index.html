<!DOCTYPE html>
<html>
<head>
	<title>Radiation: A More Cancerous Twitch.tv</title>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css">
	<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>

</head>
<body>
<!-- With the twitch embed code, when you click anywhere on the video outside 
     the video controls, it takes you to twitch. We don't want that so we need
     to have a div overlay it that blocks clicking. We make it the size of the
     window but shift it up by the size of the control bar, which I found was
     about 28 pixels -->
<div class="block-click">
</div>
<div id="chat-div" style="top:10%;left:0px;height:80%;width:400px;opacity:0.9;
">
	<iframe frameborder="0" 
		        scrolling="no" 
		        id="chat">
	</iframe>
	<div id="controls">
		<nav class="navbar navbar-inverse">
			<div class="container-fluid">
				<a class="navbar-brand channel-name" data-toggle="modal" data-target="#info"></a>
				<ul class="nav navbar-nav">
					<li><a data-toggle="modal" data-target="#options">Options</a></li>
					<li><a data-toggle="modal" data-target="#channels">Channels</a></li>
				</ul>
			</div>
		</nav>
	</div>
</div>
<iframe frameborder="0" 
        scrolling="no" 
        id="stream">
</iframe>
<div class="modal fade" id="info" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h1 class="modal-title" id="info-title"><img class="logo"><span></span></h1>
      </div>
      <div class="modal-body" id="info-modal-body">
      	<h2 id="stream-title"><span></span></h2>
      	<p id="viewers">Viewers: <span></span></p>
      	<p id="total-views">Total Views: <span></span></p>
      	<p id="Followers">Followers: <span></span></p>
        <a>Go to stream on twitch.tv</a>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="options" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Options</h4>
      </div>
      <div class="modal-body" id="options-modal-body">
      <div class="alert alert-success" role="alert">Radiation works best with the <a href="https://chrome.google.com/webstore/detail/betterttv/ajopnjidmegmdimjlfnijceegpefgped?hl=en">Better Twitch TV Chrome extension</a>. Download the extension and in the Twitch chat settings, set it to "Dark Mode".</div>
      <h2>Chat Options</h2>
      	<form id="chat-options"> 
      		<div class="form-group">
			    <label for="width">width</label>
			    <input type="text" class="form-control" id="width" value="400px">
		  	</div>
		  	<div class="form-group">
			    <label for="height">height</label>
			    <input type="text" class="form-control" id="height" value="80%">
		  	</div>
		  	<div class="form-group">
			    <label for="top">top</label>
			    <input type="text" class="form-control" id="top" value="10%">
		  	</div>
		  	<div class="form-group">
			    <label for="left">left</label>
			    <input type="text" class="form-control" id="left" value="0px">
		  	</div>
		  	<div class="form-group">
			    <label for="opacity">opacity</label>
			    <input type="text" class="form-control" id="opacity" value="0.9">
		  	</div>
      	</form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="channels" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Channels</h4>
      </div>
      <div class="modal-body" id="options-modal-body">
      Display channels here
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
function updateInfo(){
	$.get("https://api.twitch.tv/kraken/streams/"+channel, function( data ){
		$("img.logo").attr("src", data.stream.channel.logo);
		$("#info-title > span").html(channel);
		$("#stream-title > span").html(data.stream.channel.status);
		$("#viewers > span").html(data.stream.viewers);
		$("#total-views > span").html(data.stream.channel.views);
		$("#followers > span").html(data.stream.channel.followers);

	})
	$("#info-modal-body > a").attr("href", "http://www.twitch.tv/"+channel);
}

var channel = "nl_kripp";
channel = channel.toLowerCase();
$(".channel-name").html(channel);
$("#stream").attr("src", "http://www.twitch.tv/"+channel+"/embed");
$("#chat").attr("src", "http://www.twitch.tv/"+channel+"/chat");

updateInfo();

var cookieValue = document.cookie;


$("#chat-options input").change(function(){
	if($(this).val())
		changeChatValue($(this).attr("id"), $(this).val());
});


$("#chat-div").resizable({
	handles: 'n, e, s, w, ne, nw, se, sw',
	resize: function(event, ui){
		changeChatValue("width", ui.size.width);
		changeChatValue("height", ui.size.height);
	}
}).draggable({
	drag: function(event, ui){
		changeChatValue("top", ui.position.top);
		changeChatValue("left", ui.position.left);
	}
});
function changeChatValue(type, val){
	switch(type){
		case "width":
			$("#chat-div").css("width", val);
			break;
		case "height":
			$("#chat-div").css("height", val);
			break;
		case "top":
			$("#chat-div").css("top", val);
			break;
		case "left":
			$("#chat-div").css("left", val);
			break;
		default:
			$("#chat-div").css("opacity", val);
			break;
	}
	document.cookie = channel+type+"="+val;
	console.log(document.cookie);
}
</script>
</body>
</html>